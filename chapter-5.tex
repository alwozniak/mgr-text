\chapter{Ocena zgodności dokumentu z zapytaniem}

Ocena zgodności dokumentu z zapytaniem w Lucene odbywa się następująco: po wystosowaniu zapytania (przekazaniu obiektu typu \texttt{Query} do indeksu) identyfikowane są dokumenty pasujące do zapytania. Następnie dla każdego dokumentu z otrzymanej grupy obliczana jest miara dopasowania (tzw. ``score''). Zatem proces wykorzystuje dwa modele oceny znane z teorii wyszukiwania informacji: boolowski (faza pierwsza) oraz dowolny model oceny dopasowania dokumentu do zapytania (faza druga -- tutaj domyślnie wykorzystywany jest zmodyfikowany model przestrzeni wektorowej). 

Przebieg obydwóch faz może być modyfikowany przez programistę. Można zaimplementować własny model oceny trafności dopasowania poprzez przeciążenie abstrakcyjnej klasy \texttt{Similarity} lub wskazanie jednej z dostarczonych implementacji. Lucene, poza domyślnym modelem przestrzeni wektorowej, dostarcza także implementacji kilku modeli probabilistycznych (Okapi BM25 model, DFR Similarity) lub wykorzystujących właściwości języka.

Możliwa jest także ingerencja w pierwszą fazę algorytmu, poprzez dostarczenie własnej implementacji klasy \texttt{Query}.

\section{Funkcja oceny w domyślnym modelu}

\texttt{DefaultSimilarity} jest domyślną implementacją modelu przestrzeni wektorowej wykorzystywaną w Lucene. W ogólności, ocena dopasowania dokumentu do zapytania wykorzystuje zmodyfikowaną miarę podobieństwa cosinusowego, uwzględniającą takie czynniki jak długość ocenianego pola (krótsze pola dostają domyślnie wyższe oceny dopasowania) czy wprowadzone przez programistę podbicia (``boost'') dla wskazanych pól, dokumentów lub podzapytań.

\section{Modyfikowanie funkcji oceny: boosting}

Programista może wskazać, które pola, dokumenty bądź podzapytania są bardziej z jego punktu widzenia istotne. Twz. boosting (czyli podbicie ważności danego elementu) może odbywać podczas indeksowania (wtedy wartości boost przechowywane są w indeksie) lub podczas wyszukiwania. 